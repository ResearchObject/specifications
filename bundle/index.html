<!DOCTYPE html>
<html>
  <head>
    <title>Wf4Ever Research Object Bundle</title>
    <meta http-equiv='Content-Type' content='text/html;charset=utf-8'/>
    <!-- 
      === NOTA BENE ===
      For the three scripts below, if your spec resides on dev.w3 you can check them
      out in the same tree and use relative links so that they'll work offline,
     -->
    <script src='http://darobin.github.com/respec/builds/respec-w3c-common.js' async class='remove'></script>
    <!--
    <script src='http://dev.w3.org/2009/dap/ReSpec.js/js/respec.js' class='remove'></script> 
    -->

    <script class='remove'>

        
    var addExtraReferences = function() {
         for (var k in extraReferences)
             berjon.biblio[k] = extraReferences[k];
         };

     var extraReferences = {
"RO": "Stian Soiland-Reyes, Sean Bechhofer, et al.: <cite><a href='http://purl.org/wf4ever/model'>Wf4Ever Research Object Model</a></cite>. 30 November 2012. URL: <a href='http://purl.org/wf4ever/model'>http://purl.org/wf4ever/model</a>",         
"ROPrimer": "Jun Zhao, et al: <cite><a href='http://purl.org/wf4ever/ro-primer'>Wf4Ever Research Object Ontologies and Vocabularies Primer</a></cite>. 13 April 2012. URL: <a href='http://purl.org/wf4ever/primer'>http://purl.org/wf4ever/primer</a> accessed 2013-02-27",         
"ROSRS": "Piotr Holubowicz, Graham Klyne, et al.: <cite><a href='http://www.wf4ever-project.org/wiki/display/docs/RO+SRS+interface+6'>RO SRS interface 6</a></cite>. 21 December 2012. URL: <a href='http://www.wf4ever-project.org/wiki/display/docs/RO+SRS+interface+6'>http://www.wf4ever-project.org/wiki/display/docs/RO+SRS+interface+6</a>",
"UCF": "Adobe: <cite><a href='https://learn.adobe.com/wiki/display/PDFNAV/Universal+Container+Format'>Universal Container Format</a></cite>. URL: <a href='https://learn.adobe.com/wiki/display/PDFNAV/Universal+Container+Format'>https://learn.adobe.com/wiki/display/PDFNAV/Universal+Container+Format</a> accessed 2013-02-28.",
"OCF": "James Pritchett, Markus Gylling: <cite><a href='http://idpf.org/epub/30/spec/epub30-ocf-20111011.html'>EPUB Open Container Format (OCF) 3.0</a></cit>. Recommended Specification 11 October 2011. International Digital Publishing Forum (IDPF). URL: <a href='http://idpf.org/epub/30/spec/epub30-ocf-20111011.html'>http://idpf.org/epub/30/spec/epub30-ocf-20111011.html</a>",
"ORE":"<cite><a href=\"http://www.openarchives.org/ore/1.0/toc.html\">Open Archives Initiative Object Reuse and Exchange</a></cite>. <em>ORE Specifications and User Guides.</em> URL: <a href=\"http://www.openarchives.org/ore/1.0/toc.html\">http://www.openarchives.org/ore/1.0/toc.html</a>",
"ORE-RDF":"Carl Lagoze and Herbert van de Sompel <cite><a href=\"http://www.openarchives.org/ore/1.0/rdfxml\">ORE User Guide - Resource Map Implementation in RDF/XML</a></cite>.",
"ZIP": "PKWare Inc: <cite><a href='http://www.pkware.com/support/zip-app-note'></a>.ZIP File Format Specification</a></cite> version 6.3.3 (2012-09-01). URL: <a href='http://www.pkware.com/documents/casestudies/APPNOTE.TXT'>http://www.pkware.com/documents/casestudies/APPNOTE.TXT</a>",
"ODF": "Rob Weir, Michael Brauer, Patrick Durusau, Dennis Hamilton: Open Document Format for Office Applications (OpenDocument) Version 1.3, Part 3: Packages. OASIS Standard. 29 September 2011. URL: <a href=''>http://docs.oasis-open.org/office/v1.2/OpenDocument-v1.2-part3.html",

         }; 


      var respecConfig = {
          // specification status (e.g. WD, LCWD, NOTE, etc.). If in doubt use ED.
          specStatus:           "unofficial",
          
          // the specification's short name, as in http://www.w3.org/TR/short-name/
          shortName:            "ro-bundle",

          // if your specification has a subtitle that goes below the main
          // formal title, define it here
          // subtitle   :  "an excellent document",

          // if you wish the publication date to be other than today, set this
          // publishDate:  "2009-08-06",

          // if the specification's copyright date is a range of years, specify
          // the start date here:
          copyrightStart: "2013",

          // if there is a previously published draft, uncomment this and set its YYYY-MM-DD date
          // and its maturity status
          previousPublishDate:  "1977-03-15",
          previousMaturity:  "WD",
          prevRecURI: "http://example.com/previous",
          latestVersion: "http://purl.org/wf4ever/ro-bundle",
          prevVersion: "http://example.com/otherPrevious",
          thisVersion: "http://purl.org/wf4ever/ro-bundle/2013-xx-xx",
          

          // if there a publicly available Editor's Draft, this is the link
          edDraftURI: "https://raw.github.com/wf4ever/ro/gh-pages/bundle/index.html",
          

          // if this is a LCWD, uncomment and set the end of its review period
          // lcEnd: "2009-08-05",
//          doRDFa: "1.1",

          // editors, add as many as you like
          // only "name" is required
          editors:  [
              { name: "Stian Soiland-Reyes", url:
                  "http://soiland-reyes.com/stian/work/",
                company: "University of Manchester", companyURL:
                "http://www.cs.manchester.ac.uk/" },
          ],

          // authors, add as many as you like. 
          // This is optional, uncomment if you have authors as well as editors.
          // only "name" is required. Same format as editors.

          //authors:  [
          //    { name: "Your Name", url: "http://example.org/",
          //      company: "Your Company", companyURL: "http://example.com/" },
          //],
          
          // name of the WG
          wg:           "Wf4Ever project",
          
          // URI of the public WG page
          wgURI:        "http://www.wf4ever-project.org/",
          
          // name (without the @w3c.org) of the public mailing to which comments are due
          wgPublicList: "wf4ever-public@googlegroups.com",
          
          // URI of the patent status for this WG, for Rec-track documents
          // !!!! IMPORTANT !!!!
          // This is important for Rec-track documents, do not copy a patent URI from a random
          // document unless you know what you're doing. If in doubt ask your friendly neighbourhood
          // Team Contact.
          wgPatentURI:  "",
          // Add extraReferences to bibliography database
          preProcess: [addExtraReferences],
      };
    </script>
    <link rel="stylesheet" href="wf4ever.css" type="text/css" />
    <link rel="stylesheet" href="http://www.w3.org/StyleSheets/TR/w3c-unofficial" type="text/css" />
  </head>
  <body class="wf4ever">
    <div class="logo"><img src="../logo/wf4ever.png" height="100" /></div>
    <div class="status"><div><span>Wf4Ever&nbsp;Editors'&nbsp;Draft</div></span></div>
    <section id='abstract'>
    <p>
        This specification defines a file format for storage and 
        distribution of Research Objects as a ZIP archive; called a
        <strong>Research Object Bundle</strong> (RO Bundle). RO Bundles
        allow capturing a Research Object to a single file or
        byte-stream by including its manifest, annotations and some or
        all of its aggregated resources for the purposes of exporting,
        archiving, publishing and transferring research objects. </p>
    </section>
    <section id="sotd">
    This document is an Editors Draft published by the 
    <a href="http://www.wf4ever-project.org/">Wf4Ever project<a>.

    This document is a work in progress and should not yet be used as a
    basis for implementations. Questions, feedback and comments are
    kindly requested to be sent to the <a href="">wf4ever-public</a>
    mailing list/forum.
    </section>

    
    <section class="informative">
      <h2>Introduction</h2>
        <p>
            The <a href="http://purl.org/wf4ever/model">Wf4Ever Research
            Object model</a> [[!RO]]
            defines a model for aggregating the resources that contribute to a
            scientific work, including domain-specific annotations and
            provenance traces. The unit that collects these resources is called
            a <em>Research Object</em> (<abbr title="Research Object">RO</abbr>)
            and is described in an RDF-based manifest
            according to the <abbr title="Workflow forever">Wf4Ever</abbr> OWL
            ontologies.  The RO model has been formed in particular for the purpose of
            preservation of scientific workflows, but is applicable also in a
            general sense for capturing resources that are related to 
            and together form a whole.
            The <a href="">Research Object primer</a> [[ROPrimer]] provides
            further details and examples of using the RO model.
        </p>
        <p>
        The <a href="http://purl.org/wf4ever/model">specification for the RO
        model</a> does not mandate any particular form for the representation
        of Research Objects.  The Wf4Ever <a
        href='http://www.wf4ever-project.org/wiki/display/docs/RO+SRS+interface+6'>RO
        Storage and Retrieval Service API</a> [[ROSRS]] defines how
        research objects
        can be accessed and maintained on the web through a RESTful web
        service. Practical use of the RO model has however shown that
        it is also benefitial to represent a research object as a single
        ZIP archive or as file system folders for the purposes of
        downloading and editing a research object. 
        </p>
        For instance a scientific workflow system can export a workflow
        run by saving the workflow, runtime provenance trace and
        generated results to a set of files. A research object that
        represents the workflow run can aggregate and relate these
        resources. However, at the time of running the workflow (e.g. on a
        desktop computer it is not known where or if the user would
        choose to publish the RO; thus the direct use of a ROSRS service
        or minting public URIs is problematic in this situation.
        </p>
        <p>
        A <strong>Research Object Bundle</strong>, as specified by this
document, provides a way to collect the resources that are aggregated in a
research object, represented as files in a ZIP archive, in addition to their
metadata and annotations. The ZIP archive thus becomes a single representation
of a research object and which can be exported, archived, published and
transferred like a regular file or resource.
        </p>
    </section>
    <section>
        <h2>Container</h2>
        <p>
        A Research Object Bundle is a structured [[ZIP]] archive, specializing
        the <a href="https://learn.adobe.com/wiki/display/PDFNAV/UCF+overview">Adobe Universal Container Format</a> [[!UCF]]. UCF is
        based on the EPUB [[OCF]] format, but generalized to be any kind of
        container. The following section gives an informal introduction to the 
        UCF format. For the complete, normative details, see the [[!UCF]] specification.
        </p>
        <section id="ucf" class="informative">
            <h3>Universal Container Format (UCF)</h3>
            <p>
            An UCF container is based on the ZIP compression file format [[ZIP]], enforcing <a href='https://learn.adobe.com/wiki/display/PDFNAV/Zip+container'>additional restrictions</a>. The most important restrictions are:
            <ul>
                <li>Reserved filenames in the root directory:
                    <code>mimetype</code> and <code>META-INF</code></li>
                <li>Filenames must be encoded in UTF-8</li>
                <li>Compression must be Uncompressed or Flate</li>
                <li>MAY use Zip64 extensions, but SHOULD only do so when required</li>
                <li>The first file MUST be the uncompressed <code>mimetype</code> and without any extra attributes</li>
            </ul>
            </p>
            <p>UCF says about <code>mimetype</code>:
            </p>
            <blockquote cite="https://learn.adobe.com/wiki/display/PDFNAV/Zip+container">
            The first file in the Zip container MUST be a file with the ASCII
            name of <code>mimetype</code>, which holds the MIME type for the Zip
            container (<del>application/epub+zip</del> as an ASCII string; no
            padding, white-space, or case change). 
            </blockquote>
            <p>
            The actual media type to include in <code>mimetype</code> depends
            on the specific container type (the above quote uses ePub as
            an example). 
            See <a href='#ro-bundle-container' class="sectionRef"></a>.
            </p>
            <div class="practice">
                <p><span class="practicelab" id="mimetype-zip">Use zip -0 -X</span></p>
                </p>
                <p class="practicedesc">
                To add the <code>mimetype</code> file correctly on a UNIX/Linux
installation with <a href='http://www.infonn-zip.org/'>InfoZip</a>, use
<code>echo -n</code> and <code>zip -0 -X</code>. Below is an example which adds
<code>mimetype</code> correctly as the first, uncompressed file, then the remaining files (excluding <code>mimetype</code>) with the default compression (deflate): </p>
            </div>
            <pre class="example">
stain@ahtissuntu:~/test$ echo -n application/vnd.wf4ever.robundle+zip &gt; mimetype 

stain@ahtissuntu:~/test$ zip -0 -X ../example.robundle mimetype
  adding: mimetype (stored 0%)

stain@ahtissuntu:~/test$ zip -X -r ../example.robundle . -x mimetype
  adding: META-INF/ (stored 0%)
  adding: META-INF/container.xml (stored 0%)
  adding: .ro/ (stored 0%)
  adding: .ro/manifest.json (stored 0%)
  adding: helloworld.txt (stored 0%)
            </pre>
            <p>UCF says about <a
            href="https://learn.adobe.com/wiki/display/PDFNAV/UCF+container+contents#UCFcontainercontents-ContainerMETA-INFcontainerxmlOptional"><code>META-INF/container.xml</code></a>
            and rootfiles:
            </p>
            <blockquote cite="https://learn.adobe.com/wiki/display/PDFNAV/UCF+container+contents#UCFcontainercontents-ContainerMETA-INFcontainerxmlOptional">
                A UCF Container MAY include a file named
                <code>container.xml</code> in the <code>META-INF</code>
                directory at the root level of the container file system. If
                present, the <code>container.xml</code> file MAY identify
                the MIME type of, and path to, the root file for the
                container and any OPTIONAL alternative renditions included
                in the container.  
            </blockquote>
            <p>
            An example of <code>META-INF/container.xml</code> which
            defines the <em>rootfile</em> as <code>.ro/manifest.json</code>:
            </p>
            <pre class="example" data-include="example/META-INF/container.xml">
&lt;?xml version="1.0"?&gt;
&lt;container version="1.0"
    xmlns="urn:oasis:names:tc:opendocument:xmlns:container"&gt;
    &lt;rootfiles&gt;
        &lt;rootfile full-path=".ro/manifest.json" media-type="application/ld+json" /&gt;
    &lt;/rootfiles&gt;
&lt;/container&gt;
            </pre>

        </section>
        <section>
        <h3>RO bundle container</h3>
        The RO Bundle container is a specialization of a [[!UCF]] container, with
        the following additions:
        <ul>
            <li>Additional reserved filename in the root directory: <code>.ro</code></li>
            <li>The <code>mimetype</code> SHOULD be
              <code>application/vnd.wf4ever.robundle+zip</code> (see
              below)</li>
            <li>The <code>META-INF/container.xml</code>, if present,
                MUST contain at least one <code>&lt;rootfile&gt;</code> entry
                for a recognized RDF serialization of the <a
                    href=#manifest#>ORE
                manifest</a></li>
            <li>The <code>META-INF/container.xml</code>, if present,
                SHOULD contain a <code>&lt;rootfile&gt;</code> entry for
                <code>.ro/manifest.json</code> containing the <a
                href='#manifest'>ORE
                manifest</a>.
                </li> 
            </ul>
        <p>
            Applications who specialize RO Bundles MAY use a different
            <code>mimetype</code>, for instance because the research object
            bundle is used to contain application-specific data. It is
            RECOMMENDED for such extensions that the media type to end
            with <code>+zip</code> if the content of the bundle could be
            considered meaningful for a user to browse as a folder
            structure.
        </p>
        <p>
          For the purposes of this specification, the [[JSON-LD]] format
          is considered a "recognized RDF serialization", however the
          JSON-LD specification is at time of writing at a draft stage 
          and is subject to change.
        </p>
        <p>
          Beyond rootfiles, the UCF specification does not specify how
          to find the media-type for individual resources. If an
          application needs a media-type for a resource in the RO
          bundle, it MAY use the defaults below based on
          case-insensitive comparison of the file extension. 
          In the absence of a resolved media type, the media type
          <code>application/octet-stream</code> SHOULD be assumed.
          </p>
          <table>
            <tr><th>Extension</th> <th>Media type</th></tr>
            <tr>
               <td><code>.txt</code></td>
               <td><code>text/plain; charset="utf-8"</code></td>
            </tr><tr>
               <td><code>.ttl</code></td>
               <td><code>text/turtle; charset="utf-8"</code></td>
            </tr><tr>
               <td><code>.rdf</code></td>
               <td><code>application/rdf+xml</code></td>
            </tr><tr>
            </tr><tr>
               <td><code>.json</code></td>
               <td><code>application/json</code></td>
            </tr><tr>
            </tr><tr>
               <td><code>.xml</code></td>
               <td><code>application/xml</code></td>
            </tr>
          </table>
          <p>           The file <code>META-INF/manifest.xml</code> MAY be used
          according with the  
          <a href='http://docs.oasis-open.org/office/v1.2/os/OpenDocument-v1.2-os-part3.html#__RefHeading__752807_826425813'>ODF Package specification [[ODF]]</a> to
          list the contained resources and specify their individual
          media types. If present, this manifest MUST include
          <strong>all</strong> resources in the RO bundle, including
          the folder <code>.ro</code>, but excluding the folder
          <code>META-INF</code> and <code>mimetype</code>.
          To avoid confusion with the somewhat overlapping 
          <a href='#manifest'>RO manifest</a> it is NOT RECOMMENDED to include 
          <code>META-INF/manifest.xml</code> in RO Bundles. 
        </p>
        <p>

        </p>
    </section>
    </section>
    <h2 id="manifest">Manifest</h2>
    <p>
    The [[ORE]] manifest for the research object SHOULD be represented in [[!JSON-LD]] format under the name <code>.ro/manifest.json</code>, but MAY also be represented in other
formats like RDF/XML [[RDF-SYNTAX-GRAMMAR]] and [[TURTLE]] as long as they at least contain the equivalent information as <code>.ro/manifest.json</code>. All of the ORE manifests MUST be listed in the <code>META-INF/container.xml</code> as <code>&lt;rootfile&gt;</code>.
    </p>
    <p class="todo">TODO: About JSON-LD context</p>
    <p>
    An example of a manifest in JSON-LD format is included below:
    </p>
    <pre class="example" data-include="example/.ro/manifest.json">
{
  "@context": [ "http://purl.org/wf4ever/ro-bundle/context.json",
                {"root": "../" } 
              ],
  "@id": "root:",
  "dct:created": "2013-02-12T19:37:32.939Z",
  "dct:creator": "http://wf4ever-test.myopenid.com/",
  "manifest": ["manifest.json", "manifest.rdf"],
  "history": "evo_info.ttl",
  "rootFolder": "root:",
  "aggregates": [
     "root:fred.txt",
     "root:soup.jpeg",
     "http://example.com/external.txt"
  ],
  "proxies": [
    { "@id": "proxies/afedfefefef",
      "ore:proxyFor": "root:fred.txt",
      "ore:proxyIn": "root:" },
    { "@id": "proxies/fedfefefefa",
      "ore:proxyFor": "root/sopup.jpeg",
      "ore:proxyIn": "root:" },
    {   "@id": "proxies/fefefef",
        "path": "root:fred.txt" }
  ],
  "annotations": [
    { "annotates": "root:soup.jpeg",
      "annotation": "annotations/about-soup.ttl" },
    { "annotates": "root:soup.jpeg",
      "annotations": "http://example.com/blog/soup" }
  ]
}
  

</pre>
    

    <section id="conformance"></section>

    <!--<a href="#general-structure" class="sectionRef"></a> -->
    <section class='appendix'>
      <h2>Acknowledgements</h2>
      <p>
        Many thanks to Robin Berjon for making our lives so much easier with his cool tool.
      </p>
    </section>
  </body>
</html>
